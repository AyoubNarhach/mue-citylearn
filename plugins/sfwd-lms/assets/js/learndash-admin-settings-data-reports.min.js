function learndash_data_reports_do_ajax(t,e){if(void 0===t||""===t)return!1;jQuery.ajax({type:"POST",url:ajaxurl,dataType:"json",cache:!1,data:t,complete(){jQuery("button.learndash-data-reports-button").each(function(){jQuery(this).data("original-html")&&jQuery(this).html(jQuery(this).data("original-html"))}),jQuery("button.learndash-data-reports-button").prop("disabled",!1),jQuery(".ld-reports-notice--loading").remove()},success(a){if(void 0===a||void 0===a.data)return;let r=0;void 0!==a.data.totalCount&&(r=parseInt(a.data.totalCount));let o=0;if(void 0!==a.data.resultCount&&(o=parseInt(a.data.resultCount)),o<r)t.data=a.data,learndash_data_reports_do_ajax(t,e);else if(void 0!==a.data.report_download_link&&""!==a.data.report_download_link){jQuery("button.learndash-data-reports-button").each(function(){jQuery(this).data("original-html")&&jQuery(this).html(jQuery(this).data("original-html"))}),jQuery("button.learndash-data-reports-button").prop("disabled",!1);const t=jQuery(".ld-svgicon__check--reports").clone().removeClass("hidden");jQuery(".learndash-settings-page-wrap").prepend('<div class="notice notice-success is-dismissible ld-reports-notice ld-reports-notice--ready"><p>'+t[0].outerHTML+'<span class="ld-reports-notice__text">'+wp.i18n.__("Your report export is now completed.","learndash")+'</span></p><button type="button" class="notice-dismiss"><span class="screen-reader-text"><span class="screen-reader-text">'+wp.i18n.__("Dismiss this notice.","learndash")+"</span></button></div>"),window.location.href=a.data.report_download_link}}})}jQuery(function(){const t=jQuery(".ld-svgicon__refresh--reports").clone().removeClass("hidden");jQuery(".ld-svgicon__refresh--reports").attr("aria-hidden","true"),jQuery("button.learndash-data-reports-button").on("click",function(e){e.preventDefault();const a=jQuery(this),r=jQuery(this).parents(".ld-global-header-new-settings"),o=jQuery(this).attr("data-nonce"),n=jQuery(this).attr("data-slug");a.data("original-html")||a.data("original-html",a.html()),a.prepend(t),jQuery(".learndash-settings-page-wrap").prepend('<div class="notice notice-info ld-reports-notice ld-reports-notice--loading"><p>'+t.clone().attr("aria-hidden","true")[0].outerHTML+'<span class="ld-reports-notice__text">'+wp.i18n.__("Your report is being processed for export. Do not close or navigate away from this page until the report is ready.","learndash")+"</span></p></div>"),jQuery("button.learndash-data-reports-button").prop("disabled",!0),jQuery("table#learndash-data-reports a.learndash-data-reports-download-link").hide();learndash_data_reports_do_ajax({action:"learndash-data-reports",data:{init:1,slug:n,nonce:o}},r)}),jQuery(document).on("click",".ld-reports-notice .notice-dismiss",function(){jQuery(this).parents(".ld-reports-notice").remove()})});